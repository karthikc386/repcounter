<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Workout Counter</title>

<style>
:root{
  --bg:#0f172a; --card:#111c33; --text:#f8fafc; --muted:rgba(248,250,252,.75);
  --accent:#38bdf8; --good:#22c55e; --warn:#facc15; --bad:#ef4444;
  --btnText:#071018; --shadow: 0 12px 28px rgba(0,0,0,.25);
}
body.light{
  --bg:#f6f7fb; --card:#ffffff; --text:#0b1220; --muted:rgba(11,18,32,.65);
  --accent:#0284c7; --good:#16a34a; --warn:#ca8a04; --bad:#dc2626;
  --btnText:#ffffff; --shadow: 0 10px 22px rgba(2,8,23,.10);
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:18px;
}

button{
  border:none;
  cursor:pointer;
  touch-action: manipulation; /* âœ… prevent double-tap zoom safely */
}

.app{
  width:100%;
  max-width:420px;
  background: linear-gradient(180deg, #0b1630, #0a1426);
  border-radius:22px;
  padding:22px 18px 18px;
  box-shadow:0 30px 60px rgba(0,0,0,.45);
}

.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:18px;
}

h1{
  font-size:20px;
  font-weight:700;
}

.toggle{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:12px;
  color:var(--muted);
}

.switch{
  width:44px;height:26px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.10);
  position:relative;
}

.knob{
  width:20px;height:20px;
  border-radius:50%;
  background:var(--text);
  position:absolute;
  top:50%;
  left:3px;
  transform:translateY(-50%);
  transition:left .2s;
}

.switch[data-on="true"] .knob{ left:21px; }
.switch[data-on="true"]{ background:rgba(56,189,248,.25); }

.exercise{
  font-size:26px;
  font-weight:800;
  margin:10px 0 14px;
  color:#38bdf8;
}

.subline{
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:wrap;
  margin-bottom:10px;
  font-size:13px;
  color:var(--muted);
}

.pill{
  padding:6px 12px;
  border-radius:999px;
  background:rgba(255,255,255,.06);
}

.counterWrap{
  margin:18px 0 10px;
  position:relative;
}

.counter{
  font-size:clamp(64px, 22vw, 104px); /* âœ… responsive */
  font-weight:900;
  text-align:center;
}

.status{
  text-align:center;
  font-size:18px;
  min-height:24px;
  margin:6px 0 12px;
  font-weight:600;
  color:var(--good);
}
.status.warn{ color:var(--warn); }
.status.bad{ color:var(--bad); }

.progress{
  display:flex;
  justify-content:space-between;
  font-size:14px;
  color:var(--muted);
  margin-bottom:12px;
}

.controls{
  display:flex;
  gap:10px;
}
.controls button{
  flex:1;
  padding:12px;
  font-size:15px;
  border-radius:14px;
}

.start{ background:#22c55e; }
.pause{ background:#facc15; }
.reset{ background:#ef4444; }

.miniRow{
  margin-top:12px;
  display:flex;
  gap:10px;
}
.miniBtn{
  flex:1;
  padding:10px;
  font-size:14px;
  background:rgba(255,255,255,.06);
  border-radius:12px;
}

.footerNote{
  margin-top:14px;
  font-size:11px;
  opacity:.55;
}
</style>
</head>

<body>
<div class="app">
  <div class="topbar">
    <h1>Workout Counter</h1>
    <div class="toggle">
      <span>Theme</span>
      <div class="switch" id="themeSwitch" data-on="false">
        <div class="knob"></div>
      </div>
    </div>
  </div>

  <div class="exercise" id="exerciseName">â€”</div>

  <div class="subline">
    <div class="pill" id="roundInfo">Round â€”</div>
    <div class="pill" id="exerciseInfo">Reps â€” â€¢ Pace â€”</div>
  </div>

  <div class="counterWrap">
    <div class="counter" id="repCounter">0</div>
  </div>

  <div class="status" id="statusText"></div>

  <div class="progress">
    <div id="exerciseProgress">Exercise â€”</div>
    <div id="nextUp">Next â€”</div>
  </div>

  <div class="controls">
    <button class="start" id="startBtn">Start</button>
    <button class="pause" id="pauseBtn">Pause</button>
    <button class="reset" id="resetBtn">Reset</button>
  </div>

  <div class="miniRow">
    <button class="miniBtn" id="skipBtn">Skip</button>
    <button class="miniBtn" id="restartExerciseBtn">Restart</button>
  </div>

  <div class="footerNote">
    Audio & vibration require a tap on mobile.
  </div>
</div>

<script>
const workout = {
  workout:[
    { exercise:"Bhastrika Pranayama", rounds:3, repsPerRound:20, secondsPerCount:2.5, restSecondsBetweenRounds:20 },
    { exercise:"Breath of Joy", rounds:3, repsPerRound:15, secondsPerCount:3, restSecondsBetweenRounds:20 },
    { exercise:"Box Breath", rounds:2, repsPerRound:40, secondsPerCount:4, restSecondsBetweenRounds:10 },
    { exercise:"Nadi Shodhana", rounds:4, repsPerRound:20, secondsPerCount:2, restSecondsBetweenRounds:10 }
  ]
};

const settings = { countdownSeconds:3, beepEnabled:true, hapticEnabled:true };

let exerciseIndex=0, currentRound=1, currentRep=0;
let isPaused=false, isCounting=false, isResting=false;
let repInterval=null, restInterval=null, countdownInterval=null;
let audioCtx=null;

const el = id => document.getElementById(id);

const els = {
  exerciseName:el("exerciseName"),
  repCounter:el("repCounter"),
  roundInfo:el("roundInfo"),
  exerciseInfo:el("exerciseInfo"),
  status:el("statusText"),
  progress:el("exerciseProgress"),
  nextUp:el("nextUp")
};

function getEx(){ return workout.workout[exerciseIndex]; }

function updateUI(){
  const ex=getEx();
  els.exerciseName.textContent=ex?.exercise ?? "â€”";
  els.repCounter.textContent=currentRep;
  els.roundInfo.textContent=ex?`Round ${currentRound} of ${ex.rounds}`:"â€”";
  els.exerciseInfo.textContent=ex?`Reps ${ex.repsPerRound} â€¢ Pace ${ex.secondsPerCount}s`:"â€”";
  els.progress.textContent=`Exercise ${exerciseIndex+1} / ${workout.workout.length}`;
  els.nextUp.textContent="Next: "+(workout.workout[exerciseIndex+1]?.exercise ?? "â€”");
}

function setStatus(t,c=""){ els.status.className="status "+c; els.status.textContent=t; }

function ensureAudio(){
  if(audioCtx) return audioCtx;
  const C=window.AudioContext||window.webkitAudioContext;
  audioCtx=new C();
  return audioCtx;
}

function unlockAudio(){
  const c=ensureAudio();
  if(c.state==="suspended") c.resume();
}

function beep(){
  if(!settings.beepEnabled) return;
  const c=ensureAudio();
  if(c.state!=="running") return;
  const o=c.createOscillator(), g=c.createGain();
  o.frequency.value=880; g.gain.value=0.3;
  o.connect(g); g.connect(c.destination);
  o.start(); setTimeout(()=>o.stop(),50);
}

function vibrate(){ if(settings.hapticEnabled && navigator.vibrate) navigator.vibrate(15); }

function cue(){ beep(); vibrate(); }

function clearTimers(){
  clearInterval(repInterval); clearInterval(restInterval); clearInterval(countdownInterval);
}

function start(){
  unlockAudio();
  if(isCounting||isResting) return;
  let t=3;
  setStatus(`Starting in ${t}`,"warn");
  countdownInterval=setInterval(()=>{
    if(--t>0) setStatus(`Starting in ${t}`,"warn");
    else{
      clearTimers();
      setStatus("Go!");
      runReps();
    }
  },1000);
}

function runReps(){
  const ex=getEx(); isCounting=true;
  repInterval=setInterval(()=>{
    if(isPaused) return;
    currentRep++; els.repCounter.textContent=currentRep; cue();
    if(currentRep>=ex.repsPerRound){ clearTimers(); isCounting=false; nextRound(); }
  },ex.secondsPerCount*1000);
}

function nextRound(){
  const ex=getEx();
  if(currentRound>=ex.rounds){ nextExercise(); return; }
  isResting=true; let r=ex.restSecondsBetweenRounds;
  setStatus(`Rest ${r}`,"warn");
  restInterval=setInterval(()=>{
    if(--r>0) setStatus(`Rest ${r}`,"warn");
    else{ clearTimers(); isResting=false; currentRound++; currentRep=0; updateUI(); start(); }
  },1000);
}

function nextExercise(){
  if(++exerciseIndex>=workout.workout.length){ setStatus("Workout Complete ðŸŽ‰"); return; }
  currentRound=1; currentRep=0; updateUI(); start();
}

function togglePause(){ isPaused=!isPaused; setStatus(isPaused?"Paused":"Go!",isPaused?"bad":""); }

function reset(){
  clearTimers(); exerciseIndex=0; currentRound=1; currentRep=0;
  isPaused=isCounting=isResting=false;
  updateUI(); setStatus("Ready");
}

document.getElementById("startBtn").onclick=start;
document.getElementById("pauseBtn").onclick=togglePause;
document.getElementById("resetBtn").onclick=reset;
document.getElementById("skipBtn").onclick=nextExercise;
document.getElementById("restartExerciseBtn").onclick=()=>{ currentRound=1; currentRep=0; updateUI(); start(); };

document.getElementById("themeSwitch").onclick=()=>{
  const l=!document.body.classList.toggle("light");
  document.body.classList.toggle("light",!l);
};

document.addEventListener("touchstart", unlockAudio, { once:true });
document.addEventListener("click", unlockAudio, { once:true });

updateUI(); setStatus("Ready");
</script>
</body>
</html>
